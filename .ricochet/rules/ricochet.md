---
description: Справочник по командам CLI и инструментам MCP для Ricochet
globs: **/*
alwaysApply: true
---
# Справочник по командам и инструментам Ricochet

Данный документ описывает соответствие между инструментами MCP и CLI командами Ricochet, а также их функциональность.

## Основные команды управления задачами

| MCP Инструмент | CLI Команда | Описание |
|--------------|------------|-----------|
| `get_tasks` | `ricochet list` | Отображение списка всех задач с их статусами и зависимостями |
| `get_task` | `ricochet show <id>` | Отображение детальной информации о конкретной задаче |
| `next_task` | `ricochet next` | Определение следующей задачи для работы на основе зависимостей и приоритетов |
| `add_task` | `ricochet add-task --prompt="..." --research` | Добавление новой задачи с использованием ИИ для автоматической генерации деталей |
| `update_task` | `ricochet update-task --id=<id> --prompt="..." --research` | Обновление существующей задачи с использованием ИИ |
| `set_task_status` | `ricochet set-status --id=<id> --status=<status>` | Изменение статуса задачи (например, на "done", "in-progress", "pending", "deferred") |
| `add_subtask` | `ricochet add-subtask --parent=<id> --title="..." --description="..."` | Добавление новой подзадачи к родительской задаче |
| `update_subtask` | `ricochet update-subtask --id=<id> --prompt="..."` | Обновление существующей подзадачи |
| `clear_subtasks` | `ricochet clear-subtasks --id=<id>` | Удаление всех подзадач для указанной задачи |

## Управление зависимостями

| MCP Инструмент | CLI Команда | Описание |
|--------------|------------|-----------|
| `add_dependency` | `ricochet add-dependency --id=<id> --depends-on=<id>` | Добавление зависимости между задачами |
| `remove_dependency` | `ricochet remove-dependency --id=<id> --depends-on=<id>` | Удаление существующей зависимости |
| `validate_dependencies` | `ricochet validate-dependencies` | Проверка зависимостей на наличие циклов и других ошибок |
| `fix_dependencies` | `ricochet fix-dependencies` | Автоматическое исправление проблем с зависимостями |

## ИИ-интеграция и анализ

| MCP Инструмент | CLI Команда | Описание |
|--------------|------------|-----------|
| `analyze_project_complexity` | `ricochet analyze-complexity --research` | Анализ сложности задач проекта с использованием ИИ |
| `complexity_report` | `ricochet complexity-report` | Отображение отчета о сложности задач |
| `expand_task` | `ricochet expand --id=<id> --force --research` | Разбивка задачи на подзадачи с использованием ИИ |
| `expand_all` | `ricochet expand --all --force --research` | Разбивка всех задач со статусом "pending" на подзадачи |
| `update` | `ricochet update --from=<id> --prompt="..." --research` | Обновление нескольких будущих задач на основе изменений в реализации |
| `generate_prd` | `ricochet generate-prd --output='<output-file.txt>'` | Генерация PRD на основе текущего состояния проекта |
| `parse_prd` | `ricochet parse-prd --input='<prd-file.txt>'` | Генерация задач на основе PRD |

## Управление проектом

| MCP Инструмент | CLI Команда | Описание |
|--------------|------------|-----------|
| `initialize_project` | `ricochet init` | Инициализация нового проекта Ricochet |
| `generate` | `ricochet generate` | Генерация файлов задач (markdown) на основе tasks.json |
| `move_task` | `ricochet move --from=<id> --to=<id>` | Перемещение задачи или подзадачи в иерархии |
| `get_project_info` | `ricochet info` | Отображение информации о проекте и статистики задач |
| `get_config` | `ricochet config` | Отображение текущей конфигурации Ricochet |
| `set_config` | `ricochet config set <key>=<value>` | Изменение конфигурации Ricochet |

## Формат аргументов и флагов

### Общие флаги

Эти флаги доступны для большинства команд:

- `--research`: Использовать ИИ-исследование для генерации более качественных результатов (требует больше времени и API вызовов)
- `--force`: Принудительное выполнение операции, даже если это может привести к потере данных (например, перезаписи существующих подзадач)
- `--output=<file>`: Перенаправление вывода в файл
- `--verbose` или `-v`: Отображение дополнительной информации
- `--quiet` или `-q`: Минимальный вывод, только критические сообщения
- `--config=<file>`: Использование альтернативного файла конфигурации

### Формат ID

Ricochet использует числовой формат для ID задач и подзадач:

- Верхнеуровневые задачи: `1`, `2`, `3`, ...
- Подзадачи: `1.1`, `1.2`, `2.1`, ...
- Подзадачи подзадач: `1.1.1`, `1.1.2`, ...

При указании ID в командах используйте точечную нотацию для подзадач. Например:

- `ricochet show 5` - показать задачу 5
- `ricochet show 5.2` - показать подзадачу 2 задачи 5
- `ricochet add-dependency --id=3.1 --depends-on=2.4` - добавить зависимость подзадачи 3.1 от подзадачи 2.4

### Формат приоритетов

Поддерживаемые значения приоритетов:

- `high` (высокий)
- `medium` (средний, используется по умолчанию)
- `low` (низкий)

### Формат статусов

Стандартные значения статусов:

- `pending` (ожидание, используется по умолчанию)
- `in-progress` (в процессе)
- `done` (завершено)
- `deferred` (отложено)

Пользователи могут определять собственные значения статусов для специфических рабочих процессов.

## Примеры использования

### Инициализация проекта и создание задач

```sh
# Инициализация нового проекта
ricochet init

# Создание задач на основе PRD
ricochet parse-prd --input='docs/prd.txt'

# Добавление новой задачи
ricochet add-task --prompt="Реализовать API для интеграции с внешними системами"
```

### Работа с задачами

```sh
# Отображение списка задач
ricochet list

# Определение следующей задачи
ricochet next

# Просмотр конкретной задачи
ricochet show 3

# Изменение статуса задачи
ricochet set-status --id=2 --status=in-progress

# Разбивка задачи на подзадачи
ricochet expand --id=3 --research
```

### Управление зависимостями

```sh
# Добавление зависимости
ricochet add-dependency --id=4 --depends-on=2

# Удаление зависимости
ricochet remove-dependency --id=3 --depends-on=1

# Проверка зависимостей
ricochet validate-dependencies
```

### Обновление и анализ

```sh
# Анализ сложности проекта
ricochet analyze-complexity --research

# Просмотр отчета о сложности
ricochet complexity-report

# Обновление задачи на основе изменений в реализации
ricochet update-task --id=5 --prompt="Обновление из-за изменения в структуре базы данных"
```

## Интеграция с IDE через MCP

Для использования Ricochet в интегрированных средах разработки через MCP:

1. Убедитесь, что MCP-сервер Ricochet запущен:
   ```sh
   ricochet mcp-server
   ```

2. Настройте вашу среду разработки для использования MCP-сервера Ricochet:
   - Для Cursor: добавьте конфигурацию в `.cursor/mcp.json`
   - Для других MCP-совместимых инструментов: следуйте их документации

3. После настройки вы можете использовать инструменты MCP для управления задачами непосредственно из вашей IDE.

## Дополнительная информация

- Все команды имеют встроенную справку, доступную через `--help` (например, `ricochet expand --help`)
- Конфигурация Ricochet хранится в `.ricochet/config.json`
- Задачи хранятся в `.ricochet/tasks/tasks.json` и генерируются в формате markdown в `.ricochet/tasks/`
- Отчеты хранятся в `.ricochet/reports/`
- Шаблоны доступны в `.ricochet/templates/` 