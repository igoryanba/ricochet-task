# Интерактивный режим Ricochet Task

Ricochet Task предоставляет удобный интерактивный режим, который позволяет взаимодействовать с приложением через меню, а не через командную строку. Это упрощает использование для новых пользователей и ускоряет выполнение частых операций.

## Запуск интерактивного режима

Для запуска Ricochet Task в интерактивном режиме используйте флаг `-i` или `--interactive`:

```bash
ricochet-task -i
```

При запуске без аргументов интерактивный режим активируется автоматически:

```bash
ricochet-task
```

## Главное меню

Главное меню содержит следующие опции:

- **⚙️ Инициализировать проект** - Инициализация новой конфигурации Ricochet Task
- **🔑 Управление API-ключами** - Добавление, просмотр, обновление и удаление API-ключей
- **⛓️ Управление цепочками моделей** - Создание и управление цепочками моделей
- **🔖 Управление чекпоинтами** - Создание и управление чекпоинтами
- **🧩 Управление моделями** - Настройка и выбор моделей для различных ролей
- **📊 Мониторинг выполнения** - Отслеживание выполнения цепочек и задач
- **📄 Помощь** - Справка по использованию приложения
- **❌ Выход** - Выход из приложения

## Управление API-ключами

Меню управления API-ключами позволяет:

- **➕ Добавить API-ключ** - Добавление нового API-ключа для выбранного провайдера (OpenAI, Anthropic, Google и др.)
- **📋 Просмотреть API-ключи** - Просмотр списка сохраненных API-ключей
- **🔄 Обновить API-ключ** - Обновление существующего API-ключа
- **❌ Удалить API-ключ** - Удаление API-ключа
- **📤 Опубликовать ключ** - Публикация ключа для общего доступа
- **📊 Статистика использования** - Просмотр статистики использования ключей
- **⬅️ Назад в главное меню** - Возврат в главное меню

### Добавление API-ключа

При добавлении API-ключа вам будет предложено:

1. Выбрать провайдера API из списка или ввести название другого провайдера
2. Ввести API-ключ
3. Ввести описание для ключа (опционально)
4. Выбрать, делать ли ключ общедоступным для других пользователей (опционально)

После сохранения ключа вы увидите сообщение об успешном добавлении.

### Публикация ключа

При публикации ключа для общего доступа вам будет предложено:

1. Выбрать ключ из списка сохраненных
2. Указать лимит использования (максимальное количество токенов или запросов)
3. Указать период действия общего доступа (при необходимости)

После публикации ключа вы получите идентификатор для доступа к нему.

## Управление цепочками моделей

Меню управления цепочками моделей позволяет:

- **➕ Создать цепочку моделей** - Создание новой цепочки моделей
- **📋 Просмотреть цепочки моделей** - Просмотр списка сохраненных цепочек
- **🔄 Обновить цепочку моделей** - Обновление существующей цепочки
- **❌ Удалить цепочку моделей** - Удаление цепочки
- **▶️ Запустить цепочку моделей** - Запуск выбранной цепочки моделей
- **📊 Мониторинг выполнения** - Отслеживание прогресса выполнения цепочки
- **💾 Экспорт цепочки** - Экспорт цепочки в JSON-файл для переноса на другие системы
- **📥 Импорт цепочки** - Импорт цепочки из JSON-файла
- **⬅️ Назад в главное меню** - Возврат в главное меню

### Создание цепочки моделей

При создании цепочки моделей вам будет предложено:

1. Ввести имя цепочки
2. Выбрать тип цепочки (линейная, параллельная)
3. Выбрать модели из списка доступных для каждой роли в цепочке
4. Настроить параметры цепочки (входной файл, выходной файл, метаданные и т.д.)
5. Настроить параметры моделей (температура, max_tokens и др.)

Процесс создания цепочки сопровождается подсказками и предварительным просмотром:

```
🔗 Создание новой цепочки моделей

Введите имя цепочки: Анализ научных статей

Выберите тип цепочки:
> ✓ Линейная (последовательное выполнение)
  Параллельная (одновременное выполнение)

Добавление моделей в цепочку:

Роль #1: Анализатор
Выберите модель:
> ✓ anthropic / claude-3-opus
  openai / gpt-4-turbo
  openai / gpt-4o

Параметры для модели "claude-3-opus":
- Температура [0.0-1.0]: 0.3
- Максимальное количество токенов: 4000

Роль #2: Суммаризатор
Выберите модель:
> ✓ openai / gpt-4o
  anthropic / claude-3-sonnet
  mistral / mistral-large

Параметры для модели "gpt-4o":
- Температура [0.0-1.0]: 0.5
- Максимальное количество токенов: 2000

Предварительный просмотр цепочки:
Анализатор (claude-3-opus) → Суммаризатор (gpt-4o)

Сохранить цепочку? [Y/n]: Y

✅ Цепочка "Анализ научных статей" успешно создана!
```

### Запуск цепочки моделей

При запуске цепочки моделей вам будет предложено:

1. Выбрать цепочку из списка доступных
2. Указать входные данные (файл, текст или URL)
3. Указать опции запуска (с чекпоинтами, режим отладки и т.д.)
4. Подтвердить запуск

После запуска цепочки вы будете перенаправлены в режим мониторинга, где сможете отслеживать прогресс выполнения в реальном времени.

## Управление моделями

Меню управления моделями позволяет настраивать модели для различных ролей:

- **🛠️ Настроить модели** - Интерактивный выбор моделей для различных ролей
- **📋 Просмотреть настройки моделей** - Просмотр текущих настроек моделей
- **🔄 Сбросить настройки моделей** - Сброс настроек моделей к значениям по умолчанию
- **📤 Экспорт настроек** - Экспорт настроек моделей в файл
- **📥 Импорт настроек** - Импорт настроек моделей из файла
- **🔄 Синхронизировать с Task Master** - Импорт настроек из проекта Task Master
- **⬅️ Назад в главное меню** - Возврат в главное меню

### Настройка моделей

При настройке моделей вам будет предложено выбрать модели для различных ролей:

```
🤖 Настройка моделей для различных ролей

Выберите основную модель для генерации:
> ✓ anthropic / claude-3-sonnet
  openai / gpt-4-turbo
  deepseek / deepseek-coder
  mistral / mistral-large

Выберите исследовательскую модель:
> ✓ openai / gpt-4o
  anthropic / claude-3-opus
  perplexity / sonar

Выберите резервную модель:
> ✓ openai / gpt-3.5-turbo
  anthropic / claude-3-haiku
  mistral / mistral-small

Специализированные роли:

Выберите модель для роли "Анализатор":
> ✓ anthropic / claude-3-opus
  openai / gpt-4-turbo
  openai / gpt-4o

Выберите модель для роли "Суммаризатор":
> ✓ openai / gpt-4o
  anthropic / claude-3-sonnet
  mistral / mistral-large

Выберите модель для роли "Интегратор":
> ✓ deepseek / deepseek-coder
  openai / gpt-4-turbo
  anthropic / claude-3-haiku

✅ Настройка моделей завершена!
```

### Синхронизация с Task Master

Эта функция позволяет импортировать настройки моделей из проекта Task Master. При выборе этой опции вам будет предложено:

1. Указать путь к конфигурационному файлу Task Master
2. Выбрать опции импорта (основная модель, исследовательская, резервная)
3. Подтвердить импорт

После успешного импорта настройки моделей в Ricochet Task будут обновлены в соответствии с настройками Task Master.

## Мониторинг выполнения задач

Система мониторинга позволяет отслеживать прогресс выполнения цепочек и задач в реальном времени. Доступ к мониторингу можно получить несколькими способами:

- Через меню управления цепочками моделей
- Сразу после запуска цепочки
- Через главное меню, выбрав опцию "📊 Мониторинг"

### Основные функции мониторинга:

- **Общий прогресс** - Отображение общего прогресса выполнения цепочки в процентах
- **Прогресс по моделям** - Отдельные прогресс-бары для каждой модели в цепочке
- **Статус задач** - Информация о статусе выполнения каждой задачи (ожидание, выполнение, завершена)
- **Временные метрики** - Информация о времени выполнения каждой задачи и общем времени
- **Использование токенов** - Статистика по использованию токенов и стоимости запросов
- **Журнал событий** - Лог основных событий при выполнении цепочки

### Действия в мониторинге:

- **⏸️ Приостановить** - Временная приостановка выполнения цепочки с сохранением текущего состояния
- **▶️ Возобновить** - Продолжение выполнения приостановленной цепочки
- **⏹️ Остановить** - Полная остановка выполнения цепочки
- **💾 Создать чекпоинт** - Ручное создание чекпоинта в текущем состоянии
- **👁️ Просмотреть промежуточные результаты** - Просмотр текущих результатов без ожидания завершения
- **📈 Детальная статистика** - Просмотр подробной статистики по запросам и моделям
- **🔄 Переназначить модель** - Смена модели для выполнения задачи

### Визуализация прогресса:

Прогресс выполнения отображается с помощью интерактивных элементов:

```
[▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓] 100% | Цепочка: Анализ документа

├── [▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓] 100% | Модель: OpenAI GPT-4 (Анализатор)
│   └── Задача #1: Анализ структуры документа ✅ (2.3с)
│   └── Задача #2: Выделение ключевых тем ✅ (3.5с)
│   └── Задача #3: Анализ связей между темами ✅ (2.8с)
│
├── [▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓] 100% | Модель: Claude-3 (Суммаризатор)
│   └── Задача #4: Создание резюме по теме A ✅ (1.7с)
│   └── Задача #5: Создание резюме по теме B ✅ (1.9с)
│   └── Задача #6: Создание резюме по теме C ✅ (1.5с)
│
└── [▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓] 100% | Модель: DeepSeek (Интегратор)
    └── Задача #7: Объединение резюме ✅ (2.2с)
    └── Задача #8: Формирование выводов ✅ (1.8с)
```

### Детальная статистика:

При выборе опции "📈 Детальная статистика" отображается подробная информация о выполнении цепочки:

```
📊 Детальная статистика выполнения цепочки "Анализ документа"

Общая информация:
- Статус: ✅ Завершена
- Время выполнения: 16.7с
- Общее количество задач: 8
- Завершено задач: 8
- Токенов на вход: 12,456
- Токенов на выход: 5,834
- Примерная стоимость: $0.87

Статистика по моделям:
┌─────────────────────┬──────────┬────────────┬───────────┬─────────┬─────────┐
│ Модель              │ Задачи   │ Время (с)  │ Вход (т)  │ Выход(т)│ Стоим.($)│
├─────────────────────┼──────────┼────────────┼───────────┼─────────┼─────────┤
│ OpenAI GPT-4        │ 3        │ 8.6        │ 7,523     │ 2,145   │ $0.47   │
│ Claude-3            │ 3        │ 5.1        │ 3,245     │ 1,867   │ $0.28   │
│ DeepSeek            │ 2        │ 4.0        │ 1,688     │ 1,822   │ $0.12   │
└─────────────────────┴──────────┴────────────┴───────────┴─────────┴─────────┘

Топ задач по времени выполнения:
1. Задача #2: Выделение ключевых тем (3.5с)
2. Задача #3: Анализ связей между темами (2.8с)
3. Задача #1: Анализ структуры документа (2.3с)
```

## Управление чекпоинтами

Меню управления чекпоинтами позволяет:

- **📋 Просмотреть чекпоинты** - Просмотр списка сохраненных чекпоинтов
- **📖 Получить содержимое чекпоинта** - Просмотр содержимого выбранного чекпоинта
- **❌ Удалить чекпоинт** - Удаление чекпоинта
- **🔄 Восстановить из чекпоинта** - Возобновление выполнения цепочки с определенного чекпоинта
- **📤 Экспорт чекпоинта** - Экспорт чекпоинта в файл
- **📥 Импорт чекпоинта** - Импорт чекпоинта из файла
- **⬅️ Назад в главное меню** - Возврат в главное меню

### Просмотр чекпоинтов

При просмотре списка чекпоинтов отображается следующая информация:

```
📋 Список доступных чекпоинтов

┌──────────────┬────────────────────────┬─────────────────┬─────────────────────┐
│ ID           │ Цепочка                │ Время создания  │ Размер              │
├──────────────┼────────────────────────┼─────────────────┼─────────────────────┤
│ checkpoint-1 │ Анализ научных статей  │ 2023-06-01 12:30│ 345.7 КБ            │
│ checkpoint-2 │ Анализ научных статей  │ 2023-06-01 12:35│ 456.2 КБ            │
│ checkpoint-3 │ Генерация кода         │ 2023-06-02 09:15│ 124.5 КБ            │
│ checkpoint-4 │ Анализ документа       │ 2023-06-03 14:20│ 567.8 КБ            │
└──────────────┴────────────────────────┴─────────────────┴─────────────────────┘

Выберите чекпоинт для подробной информации или действий с ним:
```

### Восстановление из чекпоинта

При восстановлении из чекпоинта вам будет предложено:

1. Выбрать чекпоинт из списка
2. Выбрать опции восстановления (продолжить выполнение цепочки или создать новую)
3. Подтвердить восстановление

После восстановления из чекпоинта выполнение цепочки продолжится с сохраненного состояния.

## Особенности интерфейса

- **Цветовая индикация** - Различные цвета для информационных сообщений, ошибок, предупреждений и успешных операций
- **ASCII-арт логотип** - Стильный логотип при запуске приложения
- **Эмодзи** - Использование эмодзи для улучшения восприятия
- **Прогресс-бары** - Индикаторы загрузки для длительных операций
- **Рамки для сообщений** - Важная информация выделяется в рамках
- **Автодополнение** - Поддержка автодополнения команд и аргументов
- **История команд** - Сохранение и доступ к истории выполненных команд
- **Интерактивные подсказки** - Контекстные подсказки в процессе работы

## Горячие клавиши

В интерактивном режиме доступны следующие горячие клавиши:

- `Ctrl+C` - Выход из текущего меню или приложения
- `Tab` - Автодополнение ввода
- `↑` / `↓` - Навигация по истории команд или по пунктам меню
- `Enter` - Подтверждение выбора
- `Esc` - Отмена действия или возврат на предыдущий уровень меню
- `Ctrl+L` - Очистка экрана
- `Ctrl+R` - Поиск по истории команд
- `F1` - Вызов справки по текущему контексту

## Примеры использования

### Полный цикл работы с цепочкой моделей

1. Запустите приложение в интерактивном режиме: `ricochet-task -i`
2. Выберите "🔑 Управление API-ключами" → "➕ Добавить API-ключ" и добавьте необходимые API-ключи
3. Выберите "🧩 Управление моделями" → "🛠️ Настроить модели" и настройте модели для различных ролей
4. Выберите "⛓️ Управление цепочками моделей" → "➕ Создать цепочку моделей" и создайте новую цепочку
5. Выберите "⛓️ Управление цепочками моделей" → "▶️ Запустить цепочку моделей" и запустите созданную цепочку
6. В режиме мониторинга отслеживайте прогресс выполнения и просматривайте промежуточные результаты
7. После завершения выберите "🔖 Управление чекпоинтами" → "📖 Получить содержимое чекпоинта" для просмотра результатов

### Использование существующих настроек из Task Master

1. Запустите приложение в интерактивном режиме: `ricochet-task -i`
2. Выберите "🧩 Управление моделями" → "🔄 Синхронизировать с Task Master"
3. Укажите путь к конфигурационному файлу Task Master
4. Подтвердите импорт настроек
5. Продолжайте работу с импортированными настройками моделей 