# Обзор проекта "Рикошет"

## 1. Введение

"Рикошет" — это инновационная open-source платформа, предназначенная для решения двух ключевых задач в области работы с искусственным интеллектом:

1.  **Преодоление ограничений контекста**: Платформа предоставляет мощный инструмент для оркестрации языковых моделей (LLM), позволяя обрабатывать огромные объемы текстовой информации, которые значительно превышают контекстное окно одной модели. Это достигается за счет построения настраиваемых цепочек из нескольких AI-агентов, каждый из которых выполняет свою специализированную роль.
2.  **Демократизация доступа к AI**: "Рикошет" внедряет децентрализованную сеть для совместного использования API-ключей. Это позволяет владельцам премиум-подписок на AI-сервисы (такие как OpenAI, Anthropic, Google AI) монетизировать свои ключи, а обычным пользователям — получать доступ к передовым моделям по доступной цене.

Проект вдохновлен идеями из [Claude Task Master](https://github.com/eyaltoledano/claude-task-master) — популярной системы управления задачами для AI-ассистентов. "Рикошет" адаптирует и расширяет эти идеи, создавая целостную экосистему для эффективной работы с большими объемами информации.

## 2. Проблемы и их решение

### Проблема 1: Ограничения контекстного окна

Современные LLM (GPT-4, Claude, Gemini и др.) ограничены размером контекстного окна (от 8k до 200k токенов). Это создает значительные сложности при обработке больших документов, корпусов текстов или кодовых баз.

**Решение "Рикошет"**: 
* Сегментация больших текстов на части, соответствующие контекстному окну моделей
* Последовательная или параллельная обработка сегментов различными AI-агентами
* Агрегация и интеграция результатов в целостный выход
* Использование архитектуры задач из Task Master для отслеживания зависимостей и организации процесса обработки

### Проблема 2: Стоимость доступа к премиум AI-моделям

Высокая стоимость подписок на продвинутые LLM (например, GPT-4, Claude Opus) делает их недоступными для многих пользователей, особенно при нерегулярном использовании.

**Решение "Рикошет"**:
* Децентрализованная сеть совместного использования API-ключей
* Владельцы ключей публикуют их в сеть и получают доход от использования
* Обычные пользователи получают доступ к премиум-моделям по доступной подписке
* Система балансировки нагрузки и учета использования обеспечивает справедливое распределение запросов

## 3. Архитектура системы

"Рикошет" имеет модульную архитектуру, вдохновленную принципами Task Master, адаптированными для задач обработки больших объемов данных с помощью LLM:

```
┌───────────────────────────────────────────────────────────────┐
│                 Пользовательские интерфейсы                    │
│                                                               │
│  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐   │
│  │  CLI-клиент    │  │  Web-интерфейс │  │  MCP-клиент    │   │
│  │  (Python)      │  │  (React)       │  │  (редакторы)   │   │
│  └────────────────┘  └────────────────┘  └────────────────┘   │
└───────────────────────────────────────────────────────────────┘
                               │
                               ▼
┌───────────────────────────────────────────────────────────────┐
│                          API Gateway                           │
│                                                               │
│  REST API для внешних клиентов и сторонних интеграций         │
└───────────────────────────────────────────────────────────────┘
                               │
                               ▼
┌───────────────────────────────────────────────────────────────┐
│                       Ядро Оркестратора                        │
│                                                               │
│  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐   │
│  │ Управление     │  │ Сегментация    │  │ Управление     │   │
│  │ цепочками      │  │ текста         │  │ чекпоинтами    │   │
│  └────────────────┘  └────────────────┘  └────────────────┘   │
│                                                               │
│  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐   │
│  │ Маршрутизация  │  │ Управление     │  │ Балансировка   │   │
│  │ моделей        │  │ задачами       │  │ нагрузки       │   │
│  └────────────────┘  └────────────────┘  └────────────────┘   │
└───────────────────────────────────────────────────────────────┘
                               │
                               ▼
┌───────────────────────────────────────────────────────────────┐
│                       Сервисный слой                           │
│                                                               │
│  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐   │
│  │ Адаптеры       │  │ Управление     │  │ Система        │   │
│  │ моделей        │  │ API-ключами    │  │ выплат         │   │
│  └────────────────┘  └────────────────┘  └────────────────┘   │
└───────────────────────────────────────────────────────────────┘
                               │
                               ▼
┌───────────────────────────────────────────────────────────────┐
│                     Инфраструктурный слой                      │
│                                                               │
│  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐   │
│  │ База данных    │  │ Хранилище      │  │ Аутентификация │   │
│  │ (PostgreSQL)   │  │ (MinIO)        │  │ и авторизация  │   │
│  └────────────────┘  └────────────────┘  └────────────────┘   │
└───────────────────────────────────────────────────────────────┘
```

### Ключевые компоненты:

1. **Ядро оркестратора**:
   * Система управления цепочками моделей
   * Механизмы сегментации текста
   * Система чекпоинтов для промежуточных результатов
   * Механизмы маршрутизации между моделями
   * Адаптированная из Task Master система управления задачами и их зависимостями

2. **Система управления API-ключами**:
   * Безопасное хранение ключей
   * Балансировка нагрузки между ключами
   * Учет использования и стоимости
   * Система распределения доходов

3. **Пользовательские интерфейсы**:
   * CLI-клиент для разработчиков
   * Web-интерфейс для конечных пользователей
   * MCP-интеграция для работы в редакторах кода, основанная на архитектуре Task Master

4. **Интеграция с моделями**:
   * Адаптеры для различных провайдеров (OpenAI, Anthropic, Google AI и др.)
   * Унифицированный интерфейс для всех моделей
   * Механизмы оптимизации и кэширования

## 4. Интеграция с Task Master

"Рикошет" интегрирует и расширяет ключевые концепции Task Master:

1. **Система управления задачами**:
   * Адаптация структуры задач для представления моделей в цепочке обработки
   * Использование механизмов зависимостей для определения оптимальной последовательности выполнения
   * Интеграция с чекпоинтами для сохранения контекста между задачами
   * Расширенная система статусов задач (pending, ready, running, completed, failed, paused, cancelled)
   * Система метрик для анализа производительности и стоимости выполнения
   * Визуализация задач и их зависимостей в виде интерактивных диаграмм
   * Механизмы для автоматического разбиения больших задач на подзадачи

2. **MCP-интеграция**:
   * Использование протокола Model Control Protocol для интеграции с редакторами кода
   * Визуализация цепочек моделей и их выполнения в редакторе
   * Интерактивное конструирование цепочек обработки
   * Расширенный набор MCP-команд для управления всеми аспектами системы
   * Мониторинг выполнения задач в реальном времени с прогресс-барами
   * Панель отладки для просмотра промежуточных результатов и чекпоинтов
   * Интеграция с системой управления задачами для привязки к частям кода

3. **Управление API-ключами**:
   * Расширение системы управления API-ключами для поддержки децентрализованной сети
   * Добавление механизмов учета использования и распределения доходов

4. **Интерактивный выбор моделей**:
   * Адаптация интерфейса выбора моделей для различных ролей в цепочке
   * Расширение системы ролей для поддержки специализированных моделей
   * Интеграция выбора моделей через CLI и MCP-интерфейсы
   * Автоматический выбор моделей на основе типа задачи и доступных ресурсов
   * Система приоритезации и фолбэка на альтернативные модели

5. **Система мониторинга**:
   * Адаптация механизмов мониторинга выполнения задач
   * Интерактивная визуализация прогресса с детальной статистикой
   * Система логирования и аналитики для оценки эффективности моделей
   * Оповещения о завершении длительных процессов
   * Интеграция с редакторами для отображения прогресса непосредственно в IDE

## 5. Технологический стек

**Бэкенд**:
* Язык: Go (производительность, конкурентность, безопасность)
* Фреймворки: echo/gin для REST API
* База данных: PostgreSQL
* Хранилище артефактов: MinIO

**Клиенты**:
* CLI: Python с использованием Typer/Click
* Web: React/TypeScript
* MCP: JavaScript (для интеграции с редакторами)

**Инфраструктура**:
* Контейнеризация: Docker
* CI/CD: GitHub Actions
* Хостинг: AWS/DigitalOcean (для продакшн)

## 6. Монетизация и бизнес-модель

"Рикошет" использует инновационную децентрализованную модель монетизации:

1. **Для владельцев API-ключей**:
   * Возможность монетизировать неиспользуемую часть своей подписки
   * Доход в размере 70% от платежей пользователей, пропорционально использованию их ключей
   * Прозрачная система учета и отчетности

2. **Для пользователей**:
   * Доступ к премиум-моделям по доступной цене (5-10 долларов в месяц)
   * Отсутствие необходимости оформлять дорогие подписки для нерегулярного использования
   * Широкий выбор моделей от различных провайдеров

3. **Для платформы**:
   * Комиссия в размере 30% от платежей пользователей
   * Возможности для дополнительной монетизации через платные плагины и шаблоны

## 7. Целевая аудитория

1. **Исследователи и аналитики**:
   * Обработка больших объемов научных публикаций
   * Анализ данных и подготовка отчетов
   * Систематизация информации из различных источников

2. **Разработчики ПО**:
   * Анализ больших кодовых баз
   * Автоматизация генерации документации
   * Помощь в рефакторинге и оптимизации кода

3. **Контент-создатели**:
   * Обработка и анализ больших текстов
   * Подготовка материалов на основе исследований
   * Создание структурированного контента

4. **Бизнес-аналитики**:
   * Анализ рыночных данных и отчетов
   * Подготовка презентаций и бизнес-планов
   * Исследование конкурентов и трендов

## 8. Ближайшие шаги

1. **Разработка MVP**:
   * Базовое ядро оркестратора с поддержкой линейных цепочек
   * Интеграция с 2-3 ключевыми моделями
   * CLI-клиент для управления процессом
   * Простая система управления API-ключами

2. **Тестирование гипотез**:
   * Проверка эффективности обработки больших документов
   * Оценка качества результатов при различных конфигурациях цепочек
   * Анализ пользовательского опыта и сбор обратной связи

3. **Итеративное развитие**:
   * Расширение функциональности на основе обратной связи
   * Реализация веб-интерфейса и расширенной MCP-интеграции
   * Запуск бета-версии системы монетизации 