#!/bin/bash
# test_git_integration.sh - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Git –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

echo "üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Git –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏..."

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
log_result() {
    local test_name="$1"
    local result="$2"
    local message="$3"
    
    if [ "$result" = "success" ]; then
        echo "   ‚úÖ $test_name: $message"
    else
        echo "   ‚ùå $test_name: $message"
    fi
}

# –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
echo "1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è..."
if [ -d ".git" ]; then
    log_result "Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π" "success" "–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞–π–¥–µ–Ω"
else
    log_result "Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π" "warning" "–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è..."
    if git init > /dev/null 2>&1; then
        log_result "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Git" "success" "–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω"
    else
        log_result "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Git" "error" "–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"
    fi
fi

# –¢–µ—Å—Ç 2: –ê–Ω–∞–ª–∏–∑ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
echo "2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è..."
if ./scripts/ai-git-integration.sh . analyze > /dev/null 2>&1; then
    log_result "–ê–Ω–∞–ª–∏–∑ Git" "success" "–ê–Ω–∞–ª–∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω"
else
    log_result "–ê–Ω–∞–ª–∏–∑ Git" "error" "–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"
fi

# –¢–µ—Å—Ç 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git —Ö—É–∫–æ–≤
echo "3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Git —Ö—É–∫–æ–≤..."
if ./scripts/ai-git-hooks.sh install . > /dev/null 2>&1; then
    log_result "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git —Ö—É–∫–æ–≤" "success" "–•—É–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"
else
    log_result "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git —Ö—É–∫–æ–≤" "error" "–û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ö—É–∫–æ–≤"
fi

# –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ö—É–∫–æ–≤
echo "4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ö—É–∫–æ–≤..."
if [ -f ".git/hooks/pre-commit" ]; then
    log_result "Pre-commit —Ö—É–∫" "success" "–•—É–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
else
    log_result "Pre-commit —Ö—É–∫" "error" "–•—É–∫ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
fi

if [ -f ".git/hooks/post-commit" ]; then
    log_result "Post-commit —Ö—É–∫" "success" "–•—É–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
else
    log_result "Post-commit —Ö—É–∫" "error" "–•—É–∫ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
fi

if [ -f ".git/hooks/pre-push" ]; then
    log_result "Pre-push —Ö—É–∫" "success" "–•—É–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
else
    log_result "Pre-push —Ö—É–∫" "error" "–•—É–∫ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
fi

if [ -f ".git/hooks/post-merge" ]; then
    log_result "Post-merge —Ö—É–∫" "success" "–•—É–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
else
    log_result "Post-merge —Ö—É–∫" "error" "–•—É–∫ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
fi

# –¢–µ—Å—Ç 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ —Ö—É–∫–æ–≤
echo "5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ —Ö—É–∫–æ–≤..."
if [ -x ".git/hooks/pre-commit" ]; then
    log_result "–ü—Ä–∞–≤–∞ pre-commit" "success" "–•—É–∫ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π"
else
    log_result "–ü—Ä–∞–≤–∞ pre-commit" "error" "–•—É–∫ –Ω–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π"
fi

# –¢–µ—Å—Ç 6: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –∏–∑ TODO
echo "6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á –∏–∑ TODO..."
if ./scripts/ai-git-integration.sh . create > /dev/null 2>&1; then
    log_result "–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –∏–∑ TODO" "success" "–ó–∞–¥–∞—á–∏ —Å–æ–∑–¥–∞–Ω—ã"
else
    log_result "–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –∏–∑ TODO" "error" "–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á"
fi

# –¢–µ—Å—Ç 7: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ–º–º–∏—Ç–æ–≤
echo "7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–º–º–∏—Ç–æ–≤..."
if ./scripts/ai-git-integration.sh . sync > /dev/null 2>&1; then
    log_result "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ–º–º–∏—Ç–æ–≤" "success" "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞"
else
    log_result "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ–º–º–∏—Ç–æ–≤" "error" "–û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏"
fi

# –¢–µ—Å—Ç 8: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
echo "8. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤..."
if ./scripts/ai-git-integration.sh . update > /dev/null 2>&1; then
    log_result "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤" "success" "–°—Ç–∞—Ç—É—Å—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã"
else
    log_result "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤" "error" "–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤"
fi

# –¢–µ—Å—Ç 9: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
echo "9. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞..."
if ./scripts/ai-git-integration.sh . report > /dev/null 2>&1; then
    log_result "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞" "success" "–û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω"
else
    log_result "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞" "error" "–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞"
fi

echo "‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Git –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–æ"
